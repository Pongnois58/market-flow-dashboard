<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Trader Market Flow Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #020617;
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 24px;
    }

    .container {
      max-width: 1200px;
      width: 100%;
    }

    .header {
      margin-bottom: 24px;
    }

    .title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .subtitle {
      font-size: 14px;
      color: #9ca3af;
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.2fr);
      grid-gap: 20px;
      margin-bottom: 16px;
    }

    .card {
      background: radial-gradient(circle at top left, #1e293b, #020617);
      border-radius: 16px;
      padding: 18px 20px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
    }

    .badge {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.2);
      color: #e5e7eb;
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }

    .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .legend-color {
      width: 10px;
      height: 10px;
      border-radius: 3px;
      background: #38bdf8;
    }

    .legend-color.dxy { background: #a855f7; }
    .legend-color.es  { background: #38bdf8; }
    .legend-color.nq  { background: #0ea5e9; }
    .legend-color.gc  { background: #facc15; }
    .legend-color.btc { background: #fb923c; }
    .legend-color.eth { background: #22c55e; }

    .stats-row {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      font-size: 12px;
      color: #9ca3af;
      flex-wrap: wrap;
    }

    .stat-pill {
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(75, 85, 99, 0.8);
    }

    .flow-score {
      font-size: 34px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .flow-label {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .flow-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 500;
      margin-bottom: 10px;
    }

    .flow-chip span.emoji {
      font-size: 14px;
    }

    .flow-desc {
      font-size: 12px;
      color: #9ca3af;
      line-height: 1.5;
      margin-bottom: 10px;
      white-space: pre-line;
    }

    .flow-list {
      font-size: 12px;
      color: #e5e7eb;
      margin-top: 4px;
      padding-left: 14px;
    }

    .flow-list li {
      margin-bottom: 2px;
    }

    .actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 12px;
    }

    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 12px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(15, 23, 42, 1);
      color: #e5e7eb;
      border: 1px solid rgba(75, 85, 99, 1);
    }

    button:hover {
      background: rgba(15, 23, 42, 0.7);
    }

    .footer {
      margin-top: 6px;
      font-size: 11px;
      color: #6b7280;
      text-align: right;
    }

    @media (max-width: 900px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <header class="header">
      <div class="title">Trader Market Flow Dashboard</div>
      <div class="subtitle">
        Dashboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Äì ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤/‡∏≠‡∏≠‡∏Å DXY, ES, NQ, GC, BTC, ETH ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£
      </div>
    </header>

    <main>
      <div class="grid">
        <!-- LEFT: CHART -->
        <section class="card">
          <div class="card-header">
            <div class="card-title">Cross-Asset Snapshot</div>
            <div class="badge">Demo ‚Ä¢ Intraday % Change</div>
          </div>
          <canvas id="marketChart" height="170"></canvas>

          <div class="legend">
            <span class="legend-item"><span class="legend-color dxy"></span> DXY (Dollar Index)</span>
            <span class="legend-item"><span class="legend-color es"></span> ES (S&P 500 Futures)</span>
            <span class="legend-item"><span class="legend-color nq"></span> NQ (Nasdaq Futures)</span>
            <span class="legend-item"><span class="legend-color gc"></span> GC (Gold Futures)</span>
            <span class="legend-item"><span class="legend-color btc"></span> BTC</span>
            <span class="legend-item"><span class="legend-color eth"></span> ETH</span>
          </div>

          <div class="stats-row" id="statsRow"></div>
        </section>

        <!-- RIGHT: FLOW PANEL -->
        <section class="card">
          <div class="card-header">
            <div class="card-title">Risk-On / Risk-Off Flow Score</div>
            <div class="badge">0‚Äì100 ‚Ä¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
          </div>

          <div id="flowScore" class="flow-score">‚Äì</div>
          <div id="flowLabel" class="flow-label">Loading‚Ä¶</div>
          <div id="flowChip" class="flow-chip">
            <span class="emoji">üïí</span><span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏•‡∏≤‡∏î‚Ä¶</span>
          </div>

          <div id="flowDesc" class="flow-desc">
            Dashboard ‡∏ô‡∏µ‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÑ‡∏õ‡∏ù‡∏±‡πà‡∏á‡πÑ‡∏´‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á:
            ‚Ä¢ ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (ES, NQ, BTC, ETH)
            ‚Ä¢ ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ / ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (DXY, GC)
          </div>

          <ul id="flowList" class="flow-list">
            <!-- bullet ‡∏¢‡πà‡∏≠‡∏¢‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡πÇ‡∏î‡∏¢ JS -->
          </ul>

          <div class="actions">
            <button onclick="randomizeMarket()">üîÑ Randomize Data (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏ï‡∏•‡∏≤‡∏î)</button>
          </div>
        </section>
      </div>

      <div class="footer">
        Prototype ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏£‡∏µ‡πÄ‡∏ã‡∏ô‡∏ï‡πå‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™ ‚Äì ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏î‡πâ‡∏ß‡∏¢ real-time data/API ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
      </div>
    </main>
  </div>

  <script>
    // -------- DEMO DATA STRUCTURE --------
    let marketData = {
      dxy: { name: "DXY", change: 0.4, vol: 105, volAvg: 100 },
      es:  { name: "ES",  change: 0.8, vol: 120, volAvg: 100 },
      nq:  { name: "NQ",  change: 1.2, vol: 135, volAvg: 100 },
      gc:  { name: "GC",  change: -0.3, vol: 95, volAvg: 100 },
      btc: { name: "BTC", change: 2.5, vol: 150, volAvg: 100 },
      eth: { name: "ETH", change: 3.1, vol: 160, volAvg: 100 },
    };

    let chartInstance = null;

    // -------- LOGIC: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì FLOW SCORE --------
    function computeFlowScore(data) {
      const dxy = data.dxy.change;
      const es  = data.es.change;
      const nq  = data.nq.change;
      const gc  = data.gc.change;
      const btc = data.btc.change;
      const eth = data.eth.change;

      // idea: risk-on = ‡∏´‡∏∏‡πâ‡∏ô/crypto ‡∏ö‡∏ß‡∏Å + DXY, Gold ‡∏≠‡πà‡∏≠‡∏ô
      let score =
        50 +
        (es + nq) * 4 +         // ‡∏´‡∏∏‡πâ‡∏ô US
        (btc + eth) * 2.5 -     // ‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï
        dxy * 5 -               // ‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå‡πÅ‡∏Ç‡πá‡∏á = risk-off
        gc * 3;                 // ‡∏ó‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô = risk-off

      if (score > 100) score = 100;
      if (score < 0) score = 0;
      return Math.round(score);
    }

    function getFlowLabel(score) {
      if (score >= 70) return "‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏´‡∏°‡∏î RISK-ON ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á";
      if (score >= 40) return "‡∏ï‡∏•‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÜ ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á";
      return "‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏´‡∏°‡∏î RISK-OFF ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå/‡∏ó‡∏≠‡∏á";
    }

    function getFlowChip(score) {
      if (score >= 70) return { emoji: "üü¢", text: "Aggressive / Pro-Risk" };
      if (score >= 40) return { emoji: "üü°", text: "Neutral / Wait & See" };
      return { emoji: "üî¥", text: "Defensive / Hedge Mode" };
    }

    function buildFlowDesc(score, data) {
      const { dxy, es, nq, gc, btc, eth } = data;

      const mode =
        score >= 70
          ? "‡∏ï‡∏•‡∏≤‡∏î‡πÄ‡∏≠‡∏ô‡∏°‡∏≤‡∏ó‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (risk-on)"
          : score >= 40
          ? "‡∏ï‡∏•‡∏≤‡∏î‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà bias ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô"
          : "‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (risk-off)";

      return (
        `‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ: ${mode}\n\n` +
        `‚Ä¢ ‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå (DXY): ${dxy.change.toFixed(2)}%\n` +
        `‚Ä¢ ES (S&P 500 Futures): ${es.change.toFixed(2)}%\n` +
        `‚Ä¢ NQ (Nasdaq Futures): ${nq.change.toFixed(2)}%\n` +
        `‚Ä¢ GC (Gold Futures): ${gc.change.toFixed(2)}%\n` +
        `‚Ä¢ BTC: ${btc.change.toFixed(2)}%\n` +
        `‚Ä¢ ETH: ${eth.change.toFixed(2)}%\n\n` +
        `‡πÉ‡∏ä‡πâ dashboard ‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á shift ‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‚Üí ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡∏£‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏á`
      );
    }

    function buildFlowBullets(score, data) {
      const { dxy, es, nq, gc, btc, eth } = data;
      const bullets = [];

      if (dxy.change > 0.5) {
        bullets.push("DXY ‡∏ö‡∏ß‡∏Å‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á ‚Üí ‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå‡πÅ‡∏Ç‡πá‡∏á ‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏±‡πà‡∏á EM/‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏à‡πÇ‡∏î‡∏ô‡∏Å‡∏î‡∏î‡∏±‡∏ô");
      } else if (dxy.change < -0.3) {
        bullets.push("DXY ‡∏≠‡πà‡∏≠‡∏ô ‚Üí ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ù‡∏±‡πà‡∏á risk-on (‡∏´‡∏∏‡πâ‡∏ô/‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï)");
      }

      if (es.change > 0.5 || nq.change > 0.5) {
        bullets.push("ES/NQ ‡∏ö‡∏ß‡∏Å ‚Üí ‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡∏™‡∏´‡∏£‡∏±‡∏ê ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ù‡∏±‡πà‡∏á growth/tech (NQ)");
      } else if (es.change < -0.5 || nq.change < -0.5) {
        bullets.push("ES/NQ ‡∏•‡∏ö ‚Üí ‡∏ù‡∏±‡πà‡∏á‡∏´‡∏∏‡πâ‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏ô take profit ‡∏´‡∏£‡∏∑‡∏≠ risk-off");
      }

      if (gc.change > 0.4) {
        bullets.push("‡∏ó‡∏≠‡∏á (GC) ‡∏ö‡∏ß‡∏Å ‚Üí ‡∏°‡∏µ demand ‡∏ù‡∏±‡πà‡∏á hedge ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á/‡∏ß‡∏¥‡∏Å‡∏§‡∏ï");
      } else if (gc.change < -0.3) {
        bullets.push("‡∏ó‡∏≠‡∏á (GC) ‡∏≠‡πà‡∏≠‡∏ô ‚Üí ‡∏ô‡∏±‡∏Å‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô");
      }

      if (btc.change > 1 || eth.change > 1.5) {
        bullets.push("BTC/ETH ‡∏ö‡∏ß‡∏Å‡πÅ‡∏£‡∏á ‚Üí ‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô appetite ‡∏ù‡∏±‡πà‡∏á high beta/crypto risk");
      } else if (btc.change < -1 || eth.change < -1.5) {
        bullets.push("Crypto ‡∏≠‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß ‚Üí risk sentiment ‡∏ù‡∏±‡πà‡∏á‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï‡∏ñ‡∏≠‡∏¢‡∏•‡∏á");
      }

      if (bullets.length === 0) {
        bullets.push("‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏°‡∏≤‡∏Å ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏ô‡πâ‡∏ô‡∏£‡∏≠‡∏î‡∏π‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏£‡∏î‡∏™‡∏±‡πâ‡∏ô‡∏ï‡∏≤‡∏° intraday level");
      }

      return bullets;
    }

    // -------- RENDER CHART & UI --------
    function renderChart(data) {
      const ctx = document.getElementById("marketChart").getContext("2d");
      const labels = ["DXY", "ES", "NQ", "GC", "BTC", "ETH"];
      const changes = [
        data.dxy.change,
        data.es.change,
        data.nq.change,
        data.gc.change,
        data.btc.change,
        data.eth.change,
      ];

      if (chartInstance) chartInstance.destroy();

      chartInstance = new Chart(ctx, {
        type: "bar",
        data: {
          labels,
          datasets: [
            {
              label: "% Change",
              data: changes,
              backgroundColor: [
                "rgba(168, 85, 247, 0.9)", // DXY
                "rgba(56, 189, 248, 0.9)", // ES
                "rgba(14, 165, 233, 0.9)", // NQ
                "rgba(250, 204, 21, 0.9)", // GC
                "rgba(251, 146, 60, 0.9)", // BTC
                "rgba(34, 197, 94, 0.9)",  // ETH
              ],
              borderWidth: 0,
              borderRadius: 6,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
          },
          scales: {
            x: {
              ticks: { color: "#9ca3af", font: { size: 11 } },
              grid: { display: false },
            },
            y: {
              ticks: {
                color: "#6b7280",
                font: { size: 11 },
                callback: (v) => v + "%",
              },
              grid: { color: "rgba(55, 65, 81, 0.5)" },
            },
          },
        },
      });

      // stats pills
      const statsRow = document.getElementById("statsRow");
      statsRow.innerHTML = "";
      const arr = [data.dxy, data.es, data.nq, data.gc, data.btc, data.eth];
      arr.forEach((asset) => {
        const pill = document.createElement("div");
        pill.className = "stat-pill";
        const volBias =
          asset.vol > asset.volAvg
            ? "Vol > Avg"
            : "Vol ‚â§ Avg";
        pill.textContent = `${asset.name}: ${asset.change.toFixed(2)}% ‚Ä¢ ${volBias}`;
        statsRow.appendChild(pill);
      });
    }

    function updateFlowPanel() {
      const score = computeFlowScore(marketData);
      const label = getFlowLabel(score);
      const chip = getFlowChip(score);
      const desc = buildFlowDesc(score, marketData);
      const bullets = buildFlowBullets(score, marketData);

      document.getElementById("flowScore").textContent = score + "/100";
      document.getElementById("flowLabel").textContent = label;

      const chipEl = document.getElementById("flowChip");
      chipEl.innerHTML = "";
      const emojiSpan = document.createElement("span");
      emojiSpan.className = "emoji";
      emojiSpan.textContent = chip.emoji;
      const textSpan = document.createElement("span");
      textSpan.textContent = chip.text;
      chipEl.appendChild(emojiSpan);
      chipEl.appendChild(textSpan);

      document.getElementById("flowDesc").textContent = desc;

      const listEl = document.getElementById("flowList");
      listEl.innerHTML = "";
      bullets.forEach((b) => {
        const li = document.createElement("li");
        li.textContent = b;
        listEl.appendChild(li);
      });
    }

    // -------- RANDOMIZE (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏ï‡∏•‡∏≤‡∏î) --------
    function randomizeMarket() {
      function randChange(base, spread) {
        return base + (Math.random() - 0.5) * spread;
      }
      function randVol() {
        return 80 + Math.random() * 60;
      }

      marketData = {
        dxy: { name: "DXY", change: randChange(0, 1.2), vol: randVol(), volAvg: 100 },
        es:  { name: "ES",  change: randChange(0.4, 2.0), vol: randVol(), volAvg: 100 },
        nq:  { name: "NQ",  change: randChange(0.6, 2.5), vol: randVol(), volAvg: 100 },
        gc:  { name: "GC",  change: randChange(0, 1.8),  vol: randVol(), volAvg: 100 },
        btc: { name: "BTC", change: randChange(1.0, 7.0), vol: randVol(), volAvg: 100 },
        eth: { name: "ETH", change: randChange(1.2, 8.0), vol: randVol(), volAvg: 100 },
      };

      renderChart(marketData);
      updateFlowPanel();
    }

    // initial render
    renderChart(marketData);
    updateFlowPanel();
  </script>
</body>
</html>

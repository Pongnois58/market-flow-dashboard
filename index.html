<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Trader Market Flow Radar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #020617;
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 24px;
    }
    .container { max-width: 1200px; width: 100%; }
    .header {
      margin-bottom: 24px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
      flex-wrap: wrap;
    }
    .title-block { max-width: 800px; }
    .title { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
    .subtitle { font-size: 14px; color: #9ca3af; }
    .lang-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .lang-label { font-size: 11px; color: #9ca3af; }
    .lang-btn {
      border: 1px solid rgba(75, 85, 99, 1);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 11px;
      background: rgba(15, 23, 42, 1);
      color: #e5e7eb;
      cursor: pointer;
    }
    .lang-btn:hover { background: rgba(15, 23, 42, 0.75); }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.2fr);
      grid-gap: 20px;
      margin-bottom: 16px;
    }
    .card {
      background: radial-gradient(circle at top left, #1e293b, #020617);
      border-radius: 16px;
      padding: 18px 20px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 8px;
    }
    .card-title { font-size: 16px; font-weight: 600; }
    .badge {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.2);
      color: #e5e7eb;
      white-space: nowrap;
    }
    .chart-container { height: 260px; position: relative; }
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }
    .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .legend-color {
      width: 10px;
      height: 10px;
      border-radius: 3px;
      background: #38bdf8;
    }
    .legend-color.dxy { background: #a855f7; }
    .legend-color.es  { background: #38bdf8; }
    .legend-color.nq  { background: #0ea5e9; }
    .legend-color.gc  { background: #facc15; }
    .legend-color.btc { background: #fb923c; }
    .legend-color.eth { background: #22c55e; }

    .stats-row {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
      flex-wrap: wrap;
    }
    .stat-pill {
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(75, 85, 99, 0.8);
    }

    .flow-score { font-size: 34px; font-weight: 700; margin-bottom: 4px; }
    .flow-label { font-size: 13px; font-weight: 600; margin-bottom: 8px; }
    .flow-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 500;
      margin-bottom: 10px;
    }
    .flow-chip span.emoji { font-size: 14px; }
    .flow-desc {
      font-size: 12px;
      color: #9ca3af;
      line-height: 1.5;
      margin-bottom: 8px;
      white-space: pre-line;
    }
    .flow-list {
      font-size: 12px;
      color: #e5e7eb;
      margin-top: 4px;
      padding-left: 14px;
    }
    .flow-list li { margin-bottom: 2px; }

    .suggestion-box {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px dashed rgba(75, 85, 99, 0.9);
      font-size: 11.5px;
    }
    .suggestion-title { font-weight: 600; margin-bottom: 4px; font-size: 12px; }
    .suggestion-asset { font-weight: 600; }
    .suggestion-note { margin-top: 6px; color: #9ca3af; font-size: 10.5px; }

    .actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 12px;
      gap: 8px;
    }
    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 12px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(15, 23, 42, 1);
      color: #e5e7eb;
      border: 1px solid rgba(75, 85, 99, 1);
    }
    button:hover { background: rgba(15, 23, 42, 0.75); }

    .footer {
      margin-top: 6px;
      font-size: 11px;
      color: #6b7280;
      text-align: right;
    }

    @media (max-width: 900px) {
      .grid { grid-template-columns: 1fr; }
      .header { flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <header class="header">
      <div class="title-block">
        <div class="title" id="titleText">Trader Market Flow Radar</div>
        <div class="subtitle" id="subtitleText">
          Prototype website ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Äî ‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á DXY, ES, NQ, GC, BTC, ETH
          ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î Risk-On ‡∏´‡∏£‡∏∑‡∏≠ Risk-Off
        </div>
      </div>
      <div class="lang-toggle">
        <span class="lang-label" id="langLabel">Language</span>
        <button class="lang-btn" id="langToggleBtn">‡πÑ‡∏ó‡∏¢ / EN</button>
      </div>
    </header>

    <main>
      <div class="grid">
        <!-- LEFT: CHART -->
        <section class="card">
          <div class="card-header">
            <div class="card-title" id="chartTitle">Cross-Asset % Change Snapshot</div>
            <div class="badge" id="dataSourceBadge">Demo Data ‚Ä¢ Intraday</div>
          </div>

          <div class="chart-container">
            <canvas id="marketChart"></canvas>
          </div>

          <div class="legend">
            <span class="legend-item"><span class="legend-color dxy"></span>DXY</span>
            <span class="legend-item"><span class="legend-color es"></span>ES</span>
            <span class="legend-item"><span class="legend-color nq"></span>NQ</span>
            <span class="legend-item"><span class="legend-color gc"></span>GC</span>
            <span class="legend-item"><span class="legend-color btc"></span>BTC</span>
            <span class="legend-item"><span class="legend-color eth"></span>ETH</span>
          </div>

          <div class="stats-row" id="statsRow"></div>
        </section>

        <!-- RIGHT: FLOW + SUGGESTION -->
        <section class="card">
          <div class="card-header">
            <div class="card-title" id="flowTitle">Risk-On / Risk-Off Flow Score</div>
            <div class="badge" id="flowBadge">0‚Äì100 ‚Ä¢ Education Only</div>
          </div>

          <div id="flowScore" class="flow-score">‚Äì</div>
          <div id="flowLabel" class="flow-label">Loading‚Ä¶</div>
          <div id="flowChip" class="flow-chip">
            <span class="emoji">üïí</span>
            <span id="flowChipText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ï‡∏•‡∏≤‡∏î‚Ä¶</span>
          </div>

          <div id="flowDesc" class="flow-desc"></div>
          <ul id="flowList" class="flow-list"></ul>

          <div class="suggestion-box" id="suggestionBox">
            <div class="suggestion-title" id="suggestionTitle">Smart Focus (DEMO Recommendation)</div>
            <div id="suggestionText">
              ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏™‡∏∏‡∏î ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
            </div>
            <div class="suggestion-note" id="suggestionNote">
              * ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏±‡∏ô‡∏ï‡∏µ‡∏ú‡∏•‡∏Å‡∏≥‡πÑ‡∏£
            </div>
          </div>

          <div class="actions">
            <button onclick="randomizeMarket()" id="randomBtn">üé≤ Randomize Demo</button>
          </div>
        </section>
      </div>

      <div class="footer" id="footerText">
        Prototype for class presentation ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á real-time data ‡∏à‡∏≤‡∏Å API ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
      </div>
    </main>
  </div>

  <script>
    // ----- LANGUAGE STATE -----
    let currentLang = "th"; // "th" ‡∏´‡∏£‡∏∑‡∏≠ "en"

    const TEXTS = {
      th: {
        title: "Trader Market Flow Radar",
        subtitle:
          "Prototype website ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Äî ‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á DXY, ES, NQ, GC, BTC, ETH\n‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î Risk-On ‡∏´‡∏£‡∏∑‡∏≠ Risk-Off ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á‡πÑ‡∏´‡∏ô‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏¥‡πà‡∏á‡πÜ",
        langLabel: "‡∏†‡∏≤‡∏©‡∏≤",
        langBtn: "‡πÑ‡∏ó‡∏¢ / EN",
        chartTitle: "Cross-Asset % Change Snapshot",
        flowTitle: "Risk-On / Risk-Off Flow Score",
        flowBadge: "0‚Äì100 ‚Ä¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤",
        flowChipLoading: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ï‡∏•‡∏≤‡∏î‚Ä¶",
        suggestionTitle: "Smart Focus (‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ DEMO)",
        suggestionIntro:
          "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏™‡∏∏‡∏î ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ",
        suggestionNeutral:
          "‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏¥‡πà‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‚Üí ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏¥‡πà‡∏á‡πÜ ‡∏£‡∏≠‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏ö‡∏≤‡∏°‡∏∑‡∏≠‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô\n‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ô‡πâ‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ RR ‡∏™‡∏π‡∏á ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ä‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô",
        suggestionNote:
          "* ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏±‡∏ô‡∏ï‡∏µ‡∏ú‡∏•‡∏Å‡∏≥‡πÑ‡∏£",
        randomBtn: "üé≤ Randomize Demo",
        footer:
          "Prototype ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏£‡∏µ‡πÄ‡∏ã‡∏ô‡∏ï‡πå‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™ ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á real-time data ‡∏à‡∏≤‡∏Å API ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ",
        pillVolHigh: "Vol > Avg",
        pillVolLow: "Vol ‚â§ Avg",
        labelRiskOn: "‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏´‡∏°‡∏î RISK-ON ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á",
        labelNeutral: "‡∏ï‡∏•‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÜ ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á",
        labelRiskOff: "‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏´‡∏°‡∏î RISK-OFF ‚Äì ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå/‡∏ó‡∏≠‡∏á",
        chipRiskOn: "Aggressive / Pro-Risk",
        chipNeutral: "Neutral / Wait & See",
        chipRiskOff: "Defensive / Hedge Mode",
        marketModeOn: "‡∏ï‡∏•‡∏≤‡∏î‡πÄ‡∏≠‡∏ô‡∏°‡∏≤‡∏ó‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (risk-on)",
        marketModeMid: "‡∏ï‡∏•‡∏≤‡∏î‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà bias ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô (flow ‡∏¢‡∏±‡∏á‡πÅ‡∏Å‡∏ß‡πà‡∏á‡πÑ‡∏õ‡∏°‡∏≤)",
        marketModeOff: "‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (risk-off)",
        bullets: {
          dxyUp: "DXY ‡∏ö‡∏ß‡∏Å‡πÅ‡∏£‡∏á ‚Üí ‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå‡πÅ‡∏Ç‡πá‡∏á ‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á",
          dxyDown: "DXY ‡∏≠‡πà‡∏≠‡∏ô ‚Üí ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ù‡∏±‡πà‡∏á risk-on (‡∏´‡∏∏‡πâ‡∏ô / ‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï)",
          esNqUp: "ES/NQ ‡∏ö‡∏ß‡∏Å ‚Üí ‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡∏™‡∏´‡∏£‡∏±‡∏ê ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ù‡∏±‡πà‡∏á growth/tech (NQ)",
          esNqDown: "ES/NQ ‡∏•‡∏ö ‚Üí ‡∏´‡∏∏‡πâ‡∏ô‡πÇ‡∏î‡∏ô take profit ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° risk-off",
          gcUp: "‡∏ó‡∏≠‡∏á (GC) ‡∏ö‡∏ß‡∏Å ‚Üí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ hedge ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô",
          gcDown: "‡∏ó‡∏≠‡∏á (GC) ‡∏≠‡πà‡∏≠‡∏ô ‚Üí ‡∏ô‡∏±‡∏Å‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô",
          cryptoUp: "BTC/ETH ‡∏ö‡∏ß‡∏Å‡πÅ‡∏£‡∏á ‚Üí appetite ‡∏ù‡∏±‡πà‡∏á high beta / crypto ‡∏™‡∏π‡∏á",
          cryptoDown: "Crypto ‡∏≠‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß ‚Üí sentiment ‡∏ù‡∏±‡πà‡∏á‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ñ‡∏≠‡∏¢",
          noClear:
            "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‚Üí ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏î‡∏π ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏£‡∏î‡∏™‡∏±‡πâ‡∏ô‡∏ï‡∏≤‡∏° level intraday ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≠‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏ç‡πà",
        },
        suggestionRiskPrefix:
          "‡∏ñ‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡πÄ‡∏≠‡∏µ‡∏¢‡∏á‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∏‡∏Å (Aggressive / Risk-On):",
        suggestionDefPrefix:
          "‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (Defensive / Hedge):",
        suggestionStayOut: "‡πÇ‡∏´‡∏°‡∏î Stay Out / Low Exposure:",
      },
      en: {
        title: "Trader Market Flow Radar",
        subtitle:
          "Prototype website for traders ‚Äî track money flow across DXY, ES, NQ, GC, BTC, ETH\nso you can see if the market is Risk-On, Risk-Off, or a good time to stay out.",
        langLabel: "Language",
        langBtn: "EN / ‡πÑ‡∏ó‡∏¢",
        chartTitle: "Cross-Asset % Change Snapshot",
        flowTitle: "Risk-On / Risk-Off Flow Score",
        flowBadge: "0‚Äì100 ‚Ä¢ Educational Only",
        flowChipLoading: "Evaluating current market regime‚Ä¶",
        suggestionTitle: "Smart Focus (DEMO Recommendation)",
        suggestionIntro:
          "The system picks the strongest risk asset and the strongest defensive asset based on today's flows.",
        suggestionNeutral:
          "Market looks choppy or directionless ‚Üí this is a good time to stay on the sidelines or trade very small size.\nIf you take trades, focus on high RR setups only and wait for clear signals from your main strategy.",
        suggestionNote:
          "* For educational purposes only. Not financial advice or a guarantee of profits.",
        randomBtn: "üé≤ Randomize Demo",
        footer:
          "Prototype for class presentation ‚Äî can be extended to use real-time API data in future versions.",
        pillVolHigh: "Vol > Avg",
        pillVolLow: "Vol ‚â§ Avg",
        labelRiskOn: "RISK-ON regime ‚Äì money flowing into risk assets",
        labelNeutral: "Neutral regime ‚Äì flows mixed on both sides",
        labelRiskOff: "RISK-OFF regime ‚Äì money rotating into USD/Gold",
        chipRiskOn: "Aggressive / Pro-Risk",
        chipNeutral: "Neutral / Wait & See",
        chipRiskOff: "Defensive / Hedge Mode",
        marketModeOn: "Market is leaning toward the risk-on side.",
        marketModeMid: "Market has no clear bias yet (flows are mixed).",
        marketModeOff: "Market is leaning toward risk-off / protection mode.",
        bullets: {
          dxyUp: "DXY up strongly ‚Üí stronger USD, pressure on risk assets.",
          dxyDown: "DXY weaker ‚Üí supportive backdrop for risk-on trades.",
          esNqUp:
            "ES/NQ up ‚Üí money flowing into US equities, especially growth/tech via NQ.",
          esNqDown: "ES/NQ down ‚Üí equities under profit-taking or risk-off pressure.",
          gcUp: "Gold (GC) up ‚Üí higher demand for hedging and safety.",
          gcDown: "Gold (GC) down ‚Üí investors more willing to take risk.",
          cryptoUp:
            "BTC/ETH strong ‚Üí appetite for high beta / crypto risk is high.",
          cryptoDown:
            "Crypto selling off ‚Üí sentiment on high-risk assets is cooling.",
          noClear:
            "Moves are not very clear ‚Üí better to be patient or trade only small intraday setups.",
        },
        suggestionRiskPrefix:
          "If you want to play the Aggressive / Risk-On side, you may focus on:",
        suggestionDefPrefix:
          "If you want to stay Defensive / Hedge-focused, you may watch:",
        suggestionStayOut: "Stay Out / Low Exposure Mode:",
      },
    };

    function applyLanguageStatic() {
      const t = TEXTS[currentLang];
      document.getElementById("titleText").textContent = t.title;
      document.getElementById("subtitleText").textContent = t.subtitle;
      document.getElementById("langLabel").textContent = t.langLabel;
      document.getElementById("langToggleBtn").textContent = t.langBtn;
      document.getElementById("chartTitle").textContent = t.chartTitle;
      document.getElementById("flowTitle").textContent = t.flowTitle;
      document.getElementById("flowBadge").textContent = t.flowBadge;
      document.getElementById("flowChipText").textContent = t.flowChipLoading;
      document.getElementById("suggestionTitle").textContent = t.suggestionTitle;
      document.getElementById("suggestionNote").textContent = t.suggestionNote;
      document.getElementById("randomBtn").textContent = t.randomBtn;
      document.getElementById("footerText").textContent = t.footer;
    }

    // ----- MARKET DATA (DEMO) -----
    let marketData = {
      dxy: { name: "DXY", change: 0.4, vol: 105, volAvg: 100, type: "defensive" },
      es:  { name: "ES",  change: 0.8, vol: 120, volAvg: 100, type: "risk" },
      nq:  { name: "NQ",  change: 1.2, vol: 135, volAvg: 100, type: "risk" },
      gc:  { name: "GC",  change: -0.3, vol: 95,  volAvg: 100, type: "defensive" },
      btc: { name: "BTC", change: 2.5, vol: 150, volAvg: 100, type: "risk" },
      eth: { name: "ETH", change: 3.1, vol: 160, volAvg: 100, type: "risk" },
    };

    let chartInstance = null;

    // ----- FLOW SCORE LOGIC -----
    function computeFlowScore(data) {
      const dxy = data.dxy.change;
      const es  = data.es.change;
      const nq  = data.nq.change;
      const gc  = data.gc.change;
      const btc = data.btc.change;
      const eth = data.eth.change;

      let score =
        50 +
        (es + nq) * 4 +       // ‡∏´‡∏∏‡πâ‡∏ô US
        (btc + eth) * 2.5 -   // ‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï
        dxy * 5 -             // ‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå‡πÅ‡∏Ç‡πá‡∏á = risk-off
        gc * 3;               // ‡∏ó‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô = risk-off

      if (score > 100) score = 100;
      if (score < 0) score = 0;
      return Math.round(score);
    }

    function getFlowLabel(score) {
      const t = TEXTS[currentLang];
      if (score >= 70) return t.labelRiskOn;
      if (score >= 40) return t.labelNeutral;
      return t.labelRiskOff;
    }

    function getFlowChip(score) {
      const t = TEXTS[currentLang];
      if (score >= 70) return { emoji: "üü¢", text: t.chipRiskOn };
      if (score >= 40) return { emoji: "üü°", text: t.chipNeutral };
      return { emoji: "üî¥", text: t.chipRiskOff };
    }

    function buildFlowDesc(score, data) {
      const t = TEXTS[currentLang];
      const { dxy, es, nq, gc, btc, eth } = data;

      let modeText;
      if (score >= 70) modeText = t.marketModeOn;
      else if (score >= 40) modeText = t.marketModeMid;
      else modeText = t.marketModeOff;

      return (
        `${modeText}\n\n` +
        `‚Ä¢ DXY: ${dxy.change.toFixed(2)}%\n` +
        `‚Ä¢ ES: ${es.change.toFixed(2)}%\n` +
        `‚Ä¢ NQ: ${nq.change.toFixed(2)}%\n` +
        `‚Ä¢ GC: ${gc.change.toFixed(2)}%\n` +
        `‚Ä¢ BTC: ${btc.change.toFixed(2)}%\n` +
        `‚Ä¢ ETH: ${eth.change.toFixed(2)}%\n`
      );
    }

    function buildFlowBullets(score, data) {
      const t = TEXTS[currentLang];
      const b = t.bullets;
      const { dxy, es, nq, gc, btc, eth } = data;
      const bullets = [];

      if (dxy.change > 0.5) bullets.push(b.dxyUp);
      else if (dxy.change < -0.3) bullets.push(b.dxyDown);

      if (es.change > 0.5 || nq.change > 0.5) bullets.push(b.esNqUp);
      else if (es.change < -0.5 || nq.change < -0.5) bullets.push(b.esNqDown);

      if (gc.change > 0.4) bullets.push(b.gcUp);
      else if (gc.change < -0.3) bullets.push(b.gcDown);

      if (btc.change > 1 || eth.change > 1.5) bullets.push(b.cryptoUp);
      else if (btc.change < -1 || eth.change < -1.5) bullets.push(b.cryptoDown);

      if (bullets.length === 0) bullets.push(b.noClear);
      return bullets;
    }

    // ----- SIMPLE RECOMMENDATION ENGINE (DEMO) -----
    function buildSuggestions(data) {
      const assets = Object.values(data);
      const riskAssets = assets.filter(a => a.type === "risk");
      const defensiveAssets = assets.filter(a => a.type === "defensive");

      const calcMomentum = a => a.change * (a.vol / a.volAvg);

      let bestRisk = riskAssets[0];
      let bestDef = defensiveAssets[0];

      riskAssets.forEach(a => {
        if (calcMomentum(a) > calcMomentum(bestRisk)) bestRisk = a;
      });

      defensiveAssets.forEach(a => {
        if (calcMomentum(a) > calcMomentum(bestDef)) bestDef = a;
      });

      return {
        riskName: bestRisk.name,
        riskChange: bestRisk.change,
        defName: bestDef.name,
        defChange: bestDef.change,
      };
    }

    function updateSuggestionBox(score) {
      const t = TEXTS[currentLang];
      const s = buildSuggestions(marketData);
      const box = document.getElementById("suggestionText");

      const nearNeutral = Math.abs(score - 50) <= 10; // ‡πÇ‡∏´‡∏°‡∏î‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏¥‡πà‡∏á‡πÜ

      if (nearNeutral) {
        box.innerHTML =
          `<div class="suggestion-asset">${t.suggestionStayOut}</div>` +
          `<div style="margin-top:4px;">${t.suggestionNeutral.replace(/\n/g, "<br>")}</div>`;
      } else {
        box.innerHTML =
          `${t.suggestionIntro}<br><br>` +
          `${t.suggestionRiskPrefix}<br>` +
          `‚Ä¢ <span class="suggestion-asset">${s.riskName}</span> (${s.riskChange.toFixed(2)}%)<br><br>` +
          `${t.suggestionDefPrefix}<br>` +
          `‚Ä¢ <span class="suggestion-asset">${s.defName}</span> (${s.defChange.toFixed(2)}%)`;
      }
    }

    // ----- CHART RENDER -----
    function renderChart(data) {
      const ctx = document.getElementById("marketChart").getContext("2d");
      const labels = ["DXY", "ES", "NQ", "GC", "BTC", "ETH"];
      const changes = [
        data.dxy.change,
        data.es.change,
        data.nq.change,
        data.gc.change,
        data.btc.change,
        data.eth.change,
      ];

      if (chartInstance) chartInstance.destroy();

      chartInstance = new Chart(ctx, {
        type: "bar",
        data: {
          labels,
          datasets: [
            {
              label: "% Change",
              data: changes,
              backgroundColor: [
                "rgba(168, 85, 247, 0.9)", // DXY
                "rgba(56, 189, 248, 0.9)", // ES
                "rgba(14, 165, 233, 0.9)", // NQ
                "rgba(250, 204, 21, 0.9)", // GC
                "rgba(251, 146, 60, 0.9)", // BTC
                "rgba(34, 197, 94, 0.9)",  // ETH
              ],
              borderWidth: 0,
              borderRadius: 6,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            x: {
              ticks: { color: "#9ca3af", font: { size: 11 } },
              grid: { display: false },
            },
            y: {
              ticks: {
                color: "#6b7280",
                font: { size: 11 },
                callback: (v) => v + "%",
              },
              grid: { color: "rgba(55, 65, 81, 0.5)" },
            },
          },
        },
      });

      // Stats pills
      const t = TEXTS[currentLang];
      const statsRow = document.getElementById("statsRow");
      statsRow.innerHTML = "";
      const arr = [data.dxy, data.es, data.nq, data.gc, data.btc, data.eth];
      arr.forEach((asset) => {
        const pill = document.createElement("div");
        pill.className = "stat-pill";
        const volBias = asset.vol > asset.volAvg ? t.pillVolHigh : t.pillVolLow;
        pill.textContent = `${asset.name}: ${asset.change.toFixed(2)}% ‚Ä¢ ${volBias}`;
        statsRow.appendChild(pill);
      });
    }

    function updateFlowPanel() {
      const score = computeFlowScore(marketData);
      const label = getFlowLabel(score);
      const chip = getFlowChip(score);
      const desc = buildFlowDesc(score, marketData);
      const bullets = buildFlowBullets(score, marketData);

      document.getElementById("flowScore").textContent = score + "/100";
      document.getElementById("flowLabel").textContent = label;

      const chipEl = document.getElementById("flowChip");
      chipEl.innerHTML = "";
      const emojiSpan = document.createElement("span");
      emojiSpan.className = "emoji";
      emojiSpan.textContent = chip.emoji;
      const textSpan = document.createElement("span");
      textSpan.textContent = chip.text;
      chipEl.appendChild(emojiSpan);
      chipEl.appendChild(textSpan);

      document.getElementById("flowDesc").textContent = desc;

      const listEl = document.getElementById("flowList");
      listEl.innerHTML = "";
      bullets.forEach((b) => {
        const li = document.createElement("li");
        li.textContent = b;
        listEl.appendChild(li);
      });

      updateSuggestionBox(score);
    }

    // ----- DEMO RANDOMIZER -----
    function randomizeMarket() {
      function randChange(base, spread) {
        return base + (Math.random() - 0.5) * spread;
      }
      function randVol() {
        return 80 + Math.random() * 60;
      }

      marketData = {
        dxy: { name: "DXY", change: randChange(0, 1.0),  vol: randVol(), volAvg: 100, type: "defensive" },
        es:  { name: "ES",  change: randChange(0.4, 2),  vol: randVol(), volAvg: 100, type: "risk" },
        nq:  { name: "NQ",  change: randChange(0.6, 2.5),vol: randVol(), volAvg: 100, type: "risk" },
        gc:  { name: "GC",  change: randChange(0, 1.5),   vol: randVol(), volAvg: 100, type: "defensive" },
        btc: { name: "BTC", change: randChange(1.0, 7.0), vol: randVol(), volAvg: 100, type: "risk" },
        eth: { name: "ETH", change: randChange(1.2, 8.0), vol: randVol(), volAvg: 100, type: "risk" },
      };

      renderChart(marketData);
      updateFlowPanel();
      document.getElementById("dataSourceBadge").textContent =
        currentLang === "th"
          ? "Demo Data ‚Ä¢ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏ï‡∏•‡∏≤‡∏î"
          : "Demo Data ‚Ä¢ Randomized snapshot";
    }

    // ----- INIT -----
    function initDashboard() {
      applyLanguageStatic();
      renderChart(marketData);
      updateFlowPanel();

      document.getElementById("langToggleBtn").addEventListener("click", () => {
        currentLang = currentLang === "th" ? "en" : "th";
        applyLanguageStatic();
        renderChart(marketData);
        updateFlowPanel();
      });
    }

    document.addEventListener("DOMContentLoaded", initDashboard);
  </script>
</body>
</html>
